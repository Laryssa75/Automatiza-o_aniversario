{% extends "funcionarios/base.html" %}

<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Menu de Usuários de Acesso{% endblock %}</title>

     <!-- Bootstrap CSS -->
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap/@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-vyFq6YYB5U0EORqOR5UF9q1BMVUV7CZC2Jz3VGyZXmHRrhVyTGJCDWQtP8jhnDFl" crossorigin="anonymous">
        
     <!-- Font Awesome -->
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha384-dyB2uCW+XZ60Y3DoN4L9jCZAMNdcFS2D5Xkx5XqWjLlAOczD5SU5KkP7kgmJwP5G" crossorigin="anonymous">
</head>
<body>
    
    {% block content %}
    <div class="container text-center align-items-center min-vh">
        <div class="col-lg-6 col-md-8 col-sm-12 mx-auto">
            <div class="container mt-4">
                <div class="row w-100">
                    <h2 class="text-center mb-4"> Menu de Usuários de Acesso</h2>
                        <a 
                        href="{% url 'funcionarios:criar_usuario' %}"
                        class="btn btn-primary text-center"
                        id="botao_novo_usuario"
                        style="background-color:#c56205 !important; border:#b85c07;">Cadastrar novo Usuário</a>
                </div>
            </div>
        </div>
    </div>

    <div class="my-4 border-top mt-4"></div>

    <div class="container mt-4">
        <h2 class="text-center mt-2">Usuários</h2>
        <div class="table-responsive mt-4">
            <form id="actionForm" method="POST" action="{% url 'funcionarios:menu_usuarios' %}">
                {% csrf_token %}
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Usuario</th>
                            <th>Senha</th>
                            <th>Data de Inclusão</th>
                            <th>Setor</th>
                            <th>Perfil</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for usuario in usuarios %}
                        <tr>
                            <td>{{ usuario.id_usuario|default:"Não informado" }}</td>
                            <td>{{ usuario.usuario|default:"Não informado" }}</td>
                            <td class="senha-usuario" data-senha="{{ usuario.senha_usuario }}">
                                {% if usuario.senha_usuario  %}
                                    *****
                                {% else %}
                                    não definida
                                {% endif %}    
                            </td>
                            <td>{{ usuario.data_criarUsu|default:"Não informado" }}</td>
                            <td>{{ usuario.setor|default:"Não informado" }}</td>
                            <td>{{ usuario.perfil|default:"Não informado" }}</td>


                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="7" class="text-center">Nenhum usuário cadastrado</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </form>
        </div>
    </div>

    {% endblock %}

    <!-- <script>
    document.addEventListener("DOMContentLoaded", function() {
        const senhaFeita = document.querySelectorAll('.senha-usuario');
        
        senhaFeita.forEach(function(asterisco) {
            const senha = asterisco.getAttribute('data-senha').trim();
            console.log("Senha capturada:" ,senha);
            if (senha) {
                const senhaAsterisco = '*'.repeat(senha.length);
                asterisco.textContent = senhaAsterisco;
            } else {
                asterisco.textContent = 'não definida';
            }
        });
    });
    </script> -->

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha384-5uPPhbZxHnB8YUbOj0EDvEMZWmlFZ1yKMm3BQF7++o3rBDjF0Eo5HIr3b9pTIHeK" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-Mr44Flw8zFJ9hbHYk+sRUpPLcURJoGZTmfC+ZrPcSjqkjtF64Wl9wBvtDLZ2ZwP4" crossorigin="anonymous"></script>

</body>
</html>